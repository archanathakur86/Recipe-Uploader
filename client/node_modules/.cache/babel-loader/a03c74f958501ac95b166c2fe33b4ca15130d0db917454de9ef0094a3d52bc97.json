{"ast":null,"code":"var _jsxFileName = \"/home/navgurukul/Recipe-upload/my-mern-app/client/src/components/RecipeCard.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport estimateCalories from '../services/calorieEstimator';\nimport { Link } from 'react-router-dom';\nimport api from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function RecipeCard({\n  recipe,\n  onChange,\n  onDelete\n}) {\n  _s();\n  var _process$env$REACT_AP;\n  const base = ((_process$env$REACT_AP = process.env.REACT_APP_API_URL) === null || _process$env$REACT_AP === void 0 ? void 0 : _process$env$REACT_AP.replace('/api', '')) || 'http://localhost:5000';\n  const [liked, setLiked] = useState(false);\n  const [likes, setLikes] = useState(recipe.likes || 0);\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem('user');\n      if (!raw) return setLiked(false);\n      const me = JSON.parse(raw);\n      const favs = me && (me.favorites || []);\n      setLiked(Array.isArray(favs) && favs.findIndex(f => f && f.toString() === (recipe._id || '').toString()) !== -1);\n    } catch (err) {\n      setLiked(false);\n    }\n  }, [recipe._id]);\n  const toggleFav = async e => {\n    e && e.stopPropagation();\n    try {\n      // optimistic UI\n      const next = !liked;\n      setLiked(next);\n      setLikes(l => next ? l + 1 : Math.max(0, l - 1));\n      const res = await api.post(`/recipes/${recipe._id}/favorite`);\n\n      // update localStorage user favorites if server returned list\n      try {\n        const raw = localStorage.getItem('user');\n        if (raw) {\n          const me = JSON.parse(raw);\n          if (res && res.favorites) {\n            me.favorites = res.favorites;\n          } else {\n            // best-effort update\n            me.favorites = me.favorites || [];\n            const idx = me.favorites.findIndex(f => f && f.toString() === recipe._id.toString());\n            if (next && idx === -1) me.favorites.push(recipe._id);\n            if (!next && idx !== -1) me.favorites.splice(idx, 1);\n          }\n          localStorage.setItem('user', JSON.stringify(me));\n        }\n      } catch (err) {\n        // ignore localStorage update errors\n      }\n\n      // call parent refresh if provided\n      onChange && onChange();\n    } catch (err) {\n      console.error('favorite failed', err);\n      // rollback optimistic update\n      setLiked(prev => !prev);\n      setLikes(l => Math.max(0, l + (liked ? 1 : -1)));\n      // surface auth error\n      if (err.response && err.response.status === 401) {\n        alert('Please sign in to favorite recipes');\n      }\n    }\n  };\n  const openProfile = id => {\n    // dispatch a custom event so feed/listening components can open the drawer\n    window.dispatchEvent(new CustomEvent('openProfileDrawer', {\n      detail: {\n        id\n      }\n    }));\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"recipe-card card\",\n    children: [recipe.imageUrl && /*#__PURE__*/_jsxDEV(\"img\", {\n      src: `${base}${recipe.imageUrl}`,\n      alt: \"\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 27\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"meta\",\n      children: [/*#__PURE__*/_jsxDEV(Link, {\n        to: `/recipe/${recipe._id}`,\n        className: \"title\",\n        children: recipe.title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this), recipe.owner && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          fontSize: 12,\n          color: '#64748b'\n        },\n        children: [\"By \", /*#__PURE__*/_jsxDEV(\"a\", {\n          href: `/user/${recipe.owner._id || recipe.owner}`,\n          onClick: e => {\n            e.preventDefault();\n            openProfile(recipe.owner._id || recipe.owner);\n          },\n          children: recipe.owner.name || (typeof recipe.owner === 'string' ? recipe.owner : 'Chef')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 75\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 26\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cal\",\n        children: [recipe.caloriesTotal && recipe.caloriesTotal > 0 ? recipe.caloriesTotal : estimateCalories(recipe), \" kcal\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"actions\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: toggleFav,\n        title: \"Favorite\",\n        style: {\n          background: 'transparent',\n          border: 'none',\n          cursor: 'pointer',\n          fontSize: 16\n        },\n        children: [liked ? 'â¤ï¸' : 'ðŸ¤', \" \", likes > 0 ? likes : '']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), onDelete && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: e => {\n          e.stopPropagation();\n          if (window.confirm('Delete this recipe? This cannot be undone.')) {\n            onDelete(recipe._id);\n          }\n        },\n        title: \"Delete\",\n        style: {\n          marginLeft: 8\n        },\n        children: \"\\uD83D\\uDDD1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 5\n  }, this);\n}\n_s(RecipeCard, \"1eCkSmmKuqjV1smLdtNRnQc0z3Y=\");\n_c = RecipeCard;\nvar _c;\n$RefreshReg$(_c, \"RecipeCard\");","map":{"version":3,"names":["React","useEffect","useState","estimateCalories","Link","api","jsxDEV","_jsxDEV","RecipeCard","recipe","onChange","onDelete","_s","_process$env$REACT_AP","base","process","env","REACT_APP_API_URL","replace","liked","setLiked","likes","setLikes","raw","localStorage","getItem","me","JSON","parse","favs","favorites","Array","isArray","findIndex","f","toString","_id","err","toggleFav","e","stopPropagation","next","l","Math","max","res","post","idx","push","splice","setItem","stringify","console","error","prev","response","status","alert","openProfile","id","window","dispatchEvent","CustomEvent","detail","className","children","imageUrl","src","alt","fileName","_jsxFileName","lineNumber","columnNumber","to","title","owner","style","fontSize","color","href","onClick","preventDefault","name","caloriesTotal","background","border","cursor","confirm","marginLeft","_c","$RefreshReg$"],"sources":["/home/navgurukul/Recipe-upload/my-mern-app/client/src/components/RecipeCard.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport estimateCalories from '../services/calorieEstimator';\nimport { Link } from 'react-router-dom';\nimport api from '../services/api';\n\nexport default function RecipeCard({ recipe, onChange, onDelete }) {\n  const base = process.env.REACT_APP_API_URL?.replace('/api','') || 'http://localhost:5000';\n\n  const [liked, setLiked] = useState(false);\n  const [likes, setLikes] = useState(recipe.likes || 0);\n\n  useEffect(() => {\n    try {\n      const raw = localStorage.getItem('user');\n      if (!raw) return setLiked(false);\n      const me = JSON.parse(raw);\n      const favs = me && (me.favorites || []);\n      setLiked(Array.isArray(favs) && favs.findIndex(f => f && f.toString() === (recipe._id || '').toString()) !== -1);\n    } catch (err) {\n      setLiked(false);\n    }\n  }, [recipe._id]);\n\n  const toggleFav = async (e) => {\n    e && e.stopPropagation();\n    try {\n      // optimistic UI\n      const next = !liked;\n      setLiked(next);\n      setLikes(l => next ? l + 1 : Math.max(0, l - 1));\n\n      const res = await api.post(`/recipes/${recipe._id}/favorite`);\n\n      // update localStorage user favorites if server returned list\n      try {\n        const raw = localStorage.getItem('user');\n        if (raw) {\n          const me = JSON.parse(raw);\n          if (res && res.favorites) {\n            me.favorites = res.favorites;\n          } else {\n            // best-effort update\n            me.favorites = me.favorites || [];\n            const idx = me.favorites.findIndex(f => f && f.toString() === recipe._id.toString());\n            if (next && idx === -1) me.favorites.push(recipe._id);\n            if (!next && idx !== -1) me.favorites.splice(idx, 1);\n          }\n          localStorage.setItem('user', JSON.stringify(me));\n        }\n      } catch (err) {\n        // ignore localStorage update errors\n      }\n\n      // call parent refresh if provided\n      onChange && onChange();\n    } catch (err) {\n      console.error('favorite failed', err);\n      // rollback optimistic update\n      setLiked(prev => !prev);\n      setLikes(l => Math.max(0, l + (liked ? 1 : -1)));\n      // surface auth error\n      if (err.response && err.response.status === 401) {\n        alert('Please sign in to favorite recipes');\n      }\n    }\n  };\n\n  const openProfile = (id) => {\n    // dispatch a custom event so feed/listening components can open the drawer\n    window.dispatchEvent(new CustomEvent('openProfileDrawer', { detail: { id } }));\n  };\n\n  return (\n    <div className=\"recipe-card card\">\n      {recipe.imageUrl && <img src={`${base}${recipe.imageUrl}`} alt=\"\" />}\n      <div className=\"meta\">\n        <Link to={`/recipe/${recipe._id}`} className=\"title\">{recipe.title}</Link>\n        {recipe.owner && <div style={{ fontSize:12, color:'#64748b' }}>By <a href={`/user/${recipe.owner._id || recipe.owner}`} onClick={e => { e.preventDefault(); openProfile(recipe.owner._id || recipe.owner); }}>{recipe.owner.name || (typeof recipe.owner === 'string' ? recipe.owner : 'Chef')}</a></div>}\n          <div className=\"cal\">{(recipe.caloriesTotal && recipe.caloriesTotal > 0 ? recipe.caloriesTotal : estimateCalories(recipe))} kcal</div>\n      </div>\n      <div className=\"actions\">\n        <button onClick={toggleFav} title=\"Favorite\" style={{ background: 'transparent', border: 'none', cursor: 'pointer', fontSize: 16 }}>\n          {liked ? 'â¤ï¸' : 'ðŸ¤'} {likes > 0 ? likes : ''}\n        </button>\n        {onDelete && (\n          <button onClick={(e) => { e.stopPropagation(); if (window.confirm('Delete this recipe? This cannot be undone.')) { onDelete(recipe._id); } }} title=\"Delete\" style={{ marginLeft: 8 }}>ðŸ—‘</button>\n        )}\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}