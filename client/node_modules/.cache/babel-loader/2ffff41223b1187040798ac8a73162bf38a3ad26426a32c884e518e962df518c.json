{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Link,useNavigate}from'react-router-dom';import api from'../services/api';import'./recipeList.css';import estimateCalories from'../services/calorieEstimator';import ConfirmModal from'./ConfirmModal';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function MyRecipes(){const[recipes,setRecipes]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const navigate=useNavigate();const load=async()=>{setLoading(true);setError(null);try{const res=await api.get('/recipes/mine');setRecipes(res.data||[]);}catch(err){console.error(err);if(err.response&&err.response.status===401){setError('unauth');}else{setError('failed');}setRecipes([]);}finally{setLoading(false);}};useEffect(()=>{load();},[]);const[confirmOpen,setConfirmOpen]=useState(false);const[pendingDeleteId,setPendingDeleteId]=useState(null);const handleDeleteClick=id=>{setPendingDeleteId(id);setConfirmOpen(true);};const handleConfirmDelete=async()=>{setConfirmOpen(false);if(!pendingDeleteId)return;try{await api.delete(\"/recipes/\".concat(pendingDeleteId));setPendingDeleteId(null);load();}catch(err){var _err$response;console.error('Failed to delete recipe:',(err===null||err===void 0?void 0:(_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message||err);setError('delete-failed');}};const handleCancelDelete=()=>{setConfirmOpen(false);setPendingDeleteId(null);};const handleEdit=id=>navigate(\"/recipe/\".concat(id,\"?edit=1\"));if(loading)return/*#__PURE__*/_jsx(\"div\",{style:{padding:24},children:\"Loading...\"});if(error==='unauth'){return/*#__PURE__*/_jsx(\"div\",{style:{padding:24},children:/*#__PURE__*/_jsxs(\"p\",{children:[\"Please \",/*#__PURE__*/_jsx(Link,{to:\"/signin\",children:\"sign in\"}),\" to view your recipes.\"]})});}if(recipes.length===0){return/*#__PURE__*/_jsx(\"div\",{style:{padding:24},children:/*#__PURE__*/_jsxs(\"div\",{className:\"empty\",children:[\"No recipes yet. \",/*#__PURE__*/_jsx(Link,{to:\"/add\",children:\"Add your first recipe\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{style:{padding:24},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:'12px 0 18px',color:'#0f172a'},children:\"My Recipes\"}),/*#__PURE__*/_jsx(\"div\",{className:\"rl-grid\",children:recipes.map(r=>{var _process$env$REACT_AP;return/*#__PURE__*/_jsxs(\"article\",{className:\"rl-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rl-image\",style:{backgroundImage:\"url(\".concat(r.imageUrl?r.imageUrl.startsWith('http')?r.imageUrl:(((_process$env$REACT_AP=process.env.REACT_APP_API_URL)===null||_process$env$REACT_AP===void 0?void 0:_process$env$REACT_AP.replace('/api',''))||'')+r.imageUrl:'/assets/carbonara.jpg',\")\")},children:/*#__PURE__*/_jsxs(\"div\",{className:\"rl-cal\",children:[r.caloriesTotal&&r.caloriesTotal>0?r.caloriesTotal:estimateCalories(r),\" cal\"]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"rl-body\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"rl-title\",children:/*#__PURE__*/_jsx(Link,{to:\"/recipe/\".concat(r._id),children:r.title})}),/*#__PURE__*/_jsx(\"p\",{className:\"rl-desc\",children:(r.ingredients||[]).map(i=>i.name).slice(0,6).join(', ')})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"rl-footer\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"rl-date\",children:new Date(r.createdAt).toLocaleDateString()}),/*#__PURE__*/_jsxs(\"div\",{className:\"rl-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"icon-btn\",onClick:()=>handleEdit(r._id),children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"icon-btn\",onClick:()=>handleDeleteClick(r._id),children:\"Delete\"})]})]})]},r._id);})}),/*#__PURE__*/_jsx(ConfirmModal,{open:confirmOpen,title:\"Delete recipe\",message:\"Are you sure you want to delete this recipe? This action cannot be undone.\",confirmText:\"Yes, delete\",cancelText:\"Cancel\",onConfirm:handleConfirmDelete,onCancel:handleCancelDelete})]});}","map":{"version":3,"names":["React","useEffect","useState","Link","useNavigate","api","estimateCalories","ConfirmModal","jsx","_jsx","jsxs","_jsxs","MyRecipes","recipes","setRecipes","loading","setLoading","error","setError","navigate","load","res","get","data","err","console","response","status","confirmOpen","setConfirmOpen","pendingDeleteId","setPendingDeleteId","handleDeleteClick","id","handleConfirmDelete","delete","concat","_err$response","message","handleCancelDelete","handleEdit","style","padding","children","to","length","className","margin","color","map","r","_process$env$REACT_AP","backgroundImage","imageUrl","startsWith","process","env","REACT_APP_API_URL","replace","caloriesTotal","_id","title","ingredients","i","name","slice","join","Date","createdAt","toLocaleDateString","onClick","open","confirmText","cancelText","onConfirm","onCancel"],"sources":["/home/navgurukul/Recipe-upload/my-mern-app/client/src/components/MyRecipes.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport api from '../services/api';\nimport './recipeList.css';\nimport estimateCalories from '../services/calorieEstimator';\nimport ConfirmModal from './ConfirmModal';\n\nexport default function MyRecipes() {\n  const [recipes, setRecipes] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const navigate = useNavigate();\n\n  const load = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const res = await api.get('/recipes/mine');\n      setRecipes(res.data || []);\n    } catch (err) {\n      console.error(err);\n      if (err.response && err.response.status === 401) {\n        setError('unauth');\n      } else {\n        setError('failed');\n      }\n      setRecipes([]);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => { load(); }, []);\n\n  const [confirmOpen, setConfirmOpen] = useState(false);\n  const [pendingDeleteId, setPendingDeleteId] = useState(null);\n\n  const handleDeleteClick = (id) => {\n    setPendingDeleteId(id);\n    setConfirmOpen(true);\n  };\n\n  const handleConfirmDelete = async () => {\n    setConfirmOpen(false);\n    if (!pendingDeleteId) return;\n    try {\n      await api.delete(`/recipes/${pendingDeleteId}`);\n      setPendingDeleteId(null);\n      load();\n    } catch (err) {\n      console.error('Failed to delete recipe:', err?.response?.data || err.message || err);\n      setError('delete-failed');\n    }\n  };\n\n  const handleCancelDelete = () => { setConfirmOpen(false); setPendingDeleteId(null); };\n\n  const handleEdit = (id) => navigate(`/recipe/${id}?edit=1`);\n\n  if (loading) return <div style={{padding:24}}>Loading...</div>;\n\n  if (error === 'unauth') {\n    return (\n      <div style={{padding:24}}>\n        <p>Please <Link to=\"/signin\">sign in</Link> to view your recipes.</p>\n      </div>\n    );\n  }\n\n  if (recipes.length === 0) {\n    return (\n      <div style={{padding:24}}>\n        <div className=\"empty\">No recipes yet. <Link to=\"/add\">Add your first recipe</Link></div>\n      </div>\n    );\n  }\n\n  return (\n    <div style={{ padding: 24 }}>\n      <h2 style={{ margin: '12px 0 18px', color: '#0f172a' }}>My Recipes</h2>\n      <div className=\"rl-grid\">\n        {recipes.map(r => (\n          <article key={r._id} className=\"rl-card\">\n            <div\n              className=\"rl-image\"\n              style={{ backgroundImage: `url(${r.imageUrl ? (r.imageUrl.startsWith('http') ? r.imageUrl : (process.env.REACT_APP_API_URL?.replace('/api','') || '') + r.imageUrl) : '/assets/carbonara.jpg'})` }}\n            >\n                <div className=\"rl-cal\">{(r.caloriesTotal && r.caloriesTotal > 0 ? r.caloriesTotal : estimateCalories(r))} cal</div>\n            </div>\n\n            <div className=\"rl-body\">\n              <h3 className=\"rl-title\"><Link to={`/recipe/${r._id}`}>{r.title}</Link></h3>\n              <p className=\"rl-desc\">{(r.ingredients || []).map(i => i.name).slice(0,6).join(', ')}</p>\n            </div>\n\n            <div className=\"rl-footer\">\n              <span className=\"rl-date\">{new Date(r.createdAt).toLocaleDateString()}</span>\n              <div className=\"rl-actions\">\n                <button className=\"icon-btn\" onClick={() => handleEdit(r._id)}>Edit</button>\n                <button className=\"icon-btn\" onClick={() => handleDeleteClick(r._id)}>Delete</button>\n              </div>\n            </div>\n          </article>\n        ))}\n      </div>\n      <ConfirmModal\n        open={confirmOpen}\n        title=\"Delete recipe\"\n        message=\"Are you sure you want to delete this recipe? This action cannot be undone.\"\n        confirmText=\"Yes, delete\"\n        cancelText=\"Cancel\"\n        onConfirm={handleConfirmDelete}\n        onCancel={handleCancelDelete}\n      />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}