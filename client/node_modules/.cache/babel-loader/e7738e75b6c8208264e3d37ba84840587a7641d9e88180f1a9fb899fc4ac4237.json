{"ast":null,"code":"import React,{useState}from'react';import{useNavigate}from'react-router-dom';import api from'../services/api';import'./addrecipe.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function AddRecipe(_ref){let{user}=_ref;const navigate=useNavigate();const[title,setTitle]=useState('');const[ingredientsText,setIngredientsText]=useState('');const[instructions,setInstructions]=useState('');const[calories,setCalories]=useState('');const[isPublic,setIsPublic]=useState(false);const[image,setImage]=useState(null);const[busy,setBusy]=useState(false);const onFile=e=>{const f=e.target.files&&e.target.files[0];setImage(f||null);};const submit=async e=>{e.preventDefault();if(!user&&!localStorage.getItem('token'))return alert('Please sign in to add recipes');if(!title.trim())return alert('Please enter a title');const ingredients=ingredientsText.split('\\n').map(l=>l.trim()).filter(Boolean).map(line=>{const[name,qty]=line.split('|').map(s=>s&&s.trim());return{name:name||line,quantity:qty||''};});const form=new FormData();form.append('title',title);form.append('instructions',instructions);form.append('ingredients',JSON.stringify(ingredients));form.append('caloriesTotal',calories||'0');form.append('isPublic',isPublic);if(image)form.append('image',image);setBusy(true);try{const res=await api.post('/recipes',form,{headers:{'Content-Type':'multipart/form-data'}});// prefer navigating to the new recipe view if server returns created recipe\nif(res&&res.data&&res.data._id){navigate(\"/recipe/\".concat(res.data._id));}else{navigate('/profile');}}catch(err){var _err$response,_err$response$data;console.error(err);alert(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Failed to save recipe');}finally{setBusy(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"add-recipe-root container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create Your Recipe\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"add-recipe-form\",onSubmit:submit,children:[/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Recipe Title\"}),/*#__PURE__*/_jsx(\"input\",{value:title,onChange:e=>setTitle(e.target.value),placeholder:\"e.g., Creamy Pasta Carbonara\"})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Upload an Image\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"upload-box\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:onFile}),/*#__PURE__*/_jsx(\"div\",{className:\"upload-hint\",children:\"Click to browse or drag your image here\"})]})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Ingredients\"}),/*#__PURE__*/_jsx(\"textarea\",{value:ingredientsText,onChange:e=>setIngredientsText(e.target.value),placeholder:\"List each ingredient on a new line...\\nSpaghetti\\nPancetta\\nEggs\"})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Instructions\"}),/*#__PURE__*/_jsx(\"textarea\",{value:instructions,onChange:e=>setInstructions(e.target.value),placeholder:\"Describe the cooking steps in detail...\",rows:6})]}),/*#__PURE__*/_jsxs(\"label\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"label\",children:\"Total Calories\"}),/*#__PURE__*/_jsx(\"input\",{value:calories,onChange:e=>setCalories(e.target.value),placeholder:\"e.g., 520\"})]}),/*#__PURE__*/_jsxs(\"label\",{style:{marginTop:8},children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:isPublic,onChange:e=>setIsPublic(e.target.checked)}),\" \",/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:8},children:\"Make this recipe public (visible in Feed)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn-primary\",disabled:busy,children:busy?'Saving...':'Save Recipe'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn-cancel\",onClick:()=>navigate('/dashboard'),children:\"Cancel\"})]})]})]});}","map":{"version":3,"names":["React","useState","useNavigate","api","jsx","_jsx","jsxs","_jsxs","AddRecipe","_ref","user","navigate","title","setTitle","ingredientsText","setIngredientsText","instructions","setInstructions","calories","setCalories","isPublic","setIsPublic","image","setImage","busy","setBusy","onFile","e","f","target","files","submit","preventDefault","localStorage","getItem","alert","trim","ingredients","split","map","l","filter","Boolean","line","name","qty","s","quantity","form","FormData","append","JSON","stringify","res","post","headers","data","_id","concat","err","_err$response","_err$response$data","console","error","response","message","className","children","onSubmit","value","onChange","placeholder","type","accept","rows","style","marginTop","checked","marginLeft","disabled","onClick"],"sources":["/home/navgurukul/Recipe-upload/my-mern-app/client/src/components/AddRecipe.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport api from '../services/api';\nimport './addrecipe.css';\n\nexport default function AddRecipe({ user }) {\n  const navigate = useNavigate();\n  const [title, setTitle] = useState('');\n  const [ingredientsText, setIngredientsText] = useState('');\n  const [instructions, setInstructions] = useState('');\n  const [calories, setCalories] = useState('');\n  const [isPublic, setIsPublic] = useState(false);\n  const [image, setImage] = useState(null);\n  const [busy, setBusy] = useState(false);\n\n  const onFile = e => {\n    const f = e.target.files && e.target.files[0];\n    setImage(f || null);\n  };\n\n  const submit = async (e) => {\n    e.preventDefault();\n    if (!user && !localStorage.getItem('token')) return alert('Please sign in to add recipes');\n    if (!title.trim()) return alert('Please enter a title');\n\n    const ingredients = ingredientsText.split('\\n').map(l => l.trim()).filter(Boolean).map(line => {\n      const [name, qty] = line.split('|').map(s => s && s.trim());\n      return { name: name || line, quantity: qty || '' };\n    });\n\n    const form = new FormData();\n    form.append('title', title);\n    form.append('instructions', instructions);\n    form.append('ingredients', JSON.stringify(ingredients));\n    form.append('caloriesTotal', calories || '0');\n  form.append('isPublic', isPublic);\n    if (image) form.append('image', image);\n\n    setBusy(true);\n    try {\n      const res = await api.post('/recipes', form, { headers: { 'Content-Type': 'multipart/form-data' } });\n      // prefer navigating to the new recipe view if server returns created recipe\n      if (res && res.data && res.data._id) {\n        navigate(`/recipe/${res.data._id}`);\n      } else {\n        navigate('/profile');\n      }\n    } catch (err) {\n      console.error(err);\n      alert(err.response?.data?.message || 'Failed to save recipe');\n    } finally {\n      setBusy(false);\n    }\n  };\n\n  return (\n    <div className=\"add-recipe-root container\">\n      <h2>Create Your Recipe</h2>\n      <form className=\"add-recipe-form\" onSubmit={submit}>\n        <label>\n          <div className=\"label\">Recipe Title</div>\n          <input value={title} onChange={e => setTitle(e.target.value)} placeholder=\"e.g., Creamy Pasta Carbonara\" />\n        </label>\n\n        <label>\n          <div className=\"label\">Upload an Image</div>\n          <div className=\"upload-box\">\n            <input type=\"file\" accept=\"image/*\" onChange={onFile} />\n            <div className=\"upload-hint\">Click to browse or drag your image here</div>\n          </div>\n        </label>\n\n        <label>\n          <div className=\"label\">Ingredients</div>\n          <textarea value={ingredientsText} onChange={e => setIngredientsText(e.target.value)} placeholder={`List each ingredient on a new line...\\nSpaghetti\\nPancetta\\nEggs`} />\n        </label>\n\n        <label>\n          <div className=\"label\">Instructions</div>\n          <textarea value={instructions} onChange={e => setInstructions(e.target.value)} placeholder=\"Describe the cooking steps in detail...\" rows={6} />\n        </label>\n\n        <label>\n          <div className=\"label\">Total Calories</div>\n          <input value={calories} onChange={e => setCalories(e.target.value)} placeholder=\"e.g., 520\" />\n        </label>\n\n        <label style={{ marginTop:8 }}>\n          <input type=\"checkbox\" checked={isPublic} onChange={e => setIsPublic(e.target.checked)} /> <span style={{ marginLeft:8 }}>Make this recipe public (visible in Feed)</span>\n        </label>\n\n        <div className=\"actions\">\n          <button type=\"submit\" className=\"btn-primary\" disabled={busy}>{busy ? 'Saving...' : 'Save Recipe'}</button>\n          <button type=\"button\" className=\"btn-cancel\" onClick={() => navigate('/dashboard')}>Cancel</button>\n        </div>\n      </form>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}