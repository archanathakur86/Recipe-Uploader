{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Link,useNavigate}from'react-router-dom';import api from'../services/api';import estimateCalories from'../services/calorieEstimator';import'./newdashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ExistingUserDashboard(_ref){let{user}=_ref;const navigate=useNavigate();const name=user&&user.name||'Demo Chef';const[query,setQuery]=useState('');const handleLogout=()=>{localStorage.removeItem('token');localStorage.removeItem('user');navigate('/signin');};const goToAdd=()=>navigate('/add');const[stats,setStats]=useState({totalRecipes:0,totalCalories:0,favorites:((user===null||user===void 0?void 0:user.favorites)||[]).length||0,avgCalories:0});useEffect(()=>{if(!user)return;let mounted=true;(async()=>{try{const res=await api.get('/recipes/mine');const recs=res.data||[];const totalRecipes=recs.length;const totalCalories=recs.reduce((sum,r)=>{const c=r.caloriesTotal&&r.caloriesTotal>0?r.caloriesTotal:estimateCalories(r);return sum+(Number(c)||0);},0);const avgCalories=totalRecipes?Math.round(totalCalories/totalRecipes):0;const favorites=(user.favorites||[]).length||0;if(mounted)setStats({totalRecipes,totalCalories,favorites,avgCalories});}catch(err){console.error('Failed to load dashboard stats',err);}})();return()=>{mounted=false;};},[user]);return/*#__PURE__*/_jsxs(\"div\",{className:\"nud-root\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"nud-topbar\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"nud-left\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"nud-brand\",children:\"HomePlate\"}),/*#__PURE__*/_jsxs(\"nav\",{className:\"nud-nav\",children:[/*#__PURE__*/_jsx(Link,{to:\"/dashboard\",className:\"active\",children:\"Dashboard\"}),/*#__PURE__*/_jsxs(Link,{to:\"/add\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"icon-circle\",children:\"+\"}),\" Add Recipe\"]}),/*#__PURE__*/_jsx(Link,{to:\"/feed\",children:\"\\uD83C\\uDF10 Public Feed\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"nud-right\",children:[/*#__PURE__*/_jsx(Link,{to:\"/profile\",className:\"nud-user\",children:name}),/*#__PURE__*/_jsx(\"button\",{className:\"nud-logout\",onClick:handleLogout,children:\"\\u2934 Logout\"})]})]}),/*#__PURE__*/_jsx(\"section\",{className:\"nud-hero\",children:/*#__PURE__*/_jsx(\"div\",{className:\"nud-hero-inner\",children:/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome back, \",name,\"!\"]})})}),/*#__PURE__*/_jsxs(\"section\",{className:\"nud-stats container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-num\",children:stats.totalRecipes}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Total Recipes\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-num\",children:stats.totalCalories.toLocaleString()}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Total Calories\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-num\",children:stats.favorites}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Favorites\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"stat-num\",children:stats.avgCalories}),/*#__PURE__*/_jsx(\"div\",{className:\"stat-label\",children:\"Avg Calories\"})]})]}),/*#__PURE__*/_jsx(\"section\",{className:\"container\",style:{paddingTop:8},children:/*#__PURE__*/_jsxs(\"div\",{style:{maxWidth:1100,margin:'0 auto 20px',display:'flex',gap:12},children:[/*#__PURE__*/_jsx(\"input\",{value:query,onChange:e=>setQuery(e.target.value),placeholder:\"Search recipes by title, ingredients, or instructions...\",style:{flex:1,padding:'12px 14px',borderRadius:10,border:'1px solid rgba(15,23,42,0.08)',fontSize:15}}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:()=>{/* implement search */},children:\"Search\"})]})}),/*#__PURE__*/_jsx(\"main\",{className:\"nud-empty container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"nud-empty-card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Your recipes\"}),/*#__PURE__*/_jsx(\"p\",{children:\"You have recipes \\u2014 they will show here. Use the search above to filter.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"nud-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-primary\",onClick:goToAdd,children:\"Add New Recipe\"}),/*#__PURE__*/_jsx(Link,{className:\"btn-secondary\",to:\"/feed\",children:\"Explore Public Feed\"})]})]})})]});}","map":{"version":3,"names":["React","useState","useEffect","Link","useNavigate","api","estimateCalories","jsx","_jsx","jsxs","_jsxs","ExistingUserDashboard","_ref","user","navigate","name","query","setQuery","handleLogout","localStorage","removeItem","goToAdd","stats","setStats","totalRecipes","totalCalories","favorites","length","avgCalories","mounted","res","get","recs","data","reduce","sum","r","c","caloriesTotal","Number","Math","round","err","console","error","className","children","to","onClick","toLocaleString","style","paddingTop","maxWidth","margin","display","gap","value","onChange","e","target","placeholder","flex","padding","borderRadius","border","fontSize"],"sources":["/home/navgurukul/Recipe-upload/my-mern-app/client/src/components/ExistingUserDashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link, useNavigate } from 'react-router-dom';\nimport api from '../services/api';\nimport estimateCalories from '../services/calorieEstimator';\nimport './newdashboard.css';\n\nexport default function ExistingUserDashboard({ user }) {\n  const navigate = useNavigate();\n  const name = (user && user.name) || 'Demo Chef';\n  const [query, setQuery] = useState('');\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    navigate('/signin');\n  };\n\n  const goToAdd = () => navigate('/add');\n\n  const [stats, setStats] = useState({ totalRecipes: 0, totalCalories: 0, favorites: (user?.favorites || []).length || 0, avgCalories: 0 });\n\n  useEffect(() => {\n    if (!user) return;\n    let mounted = true;\n    (async () => {\n      try {\n        const res = await api.get('/recipes/mine');\n        const recs = res.data || [];\n        const totalRecipes = recs.length;\n        const totalCalories = recs.reduce((sum, r) => {\n          const c = (r.caloriesTotal && r.caloriesTotal > 0) ? r.caloriesTotal : estimateCalories(r);\n          return sum + (Number(c) || 0);\n        }, 0);\n        const avgCalories = totalRecipes ? Math.round(totalCalories / totalRecipes) : 0;\n        const favorites = (user.favorites || []).length || 0;\n        if (mounted) setStats({ totalRecipes, totalCalories, favorites, avgCalories });\n      } catch (err) {\n        console.error('Failed to load dashboard stats', err);\n      }\n    })();\n    return () => { mounted = false; };\n  }, [user]);\n\n  return (\n    <div className=\"nud-root\">\n      <header className=\"nud-topbar\">\n        <div className=\"nud-left\">\n          <div className=\"nud-brand\">HomePlate</div>\n          <nav className=\"nud-nav\">\n            <Link to=\"/dashboard\" className=\"active\">Dashboard</Link>\n            <Link to=\"/add\"><span className=\"icon-circle\">+</span> Add Recipe</Link>\n            <Link to=\"/feed\">üåê Public Feed</Link>\n          </nav>\n        </div>\n\n        <div className=\"nud-right\">\n          <Link to=\"/profile\" className=\"nud-user\">{name}</Link>\n          <button className=\"nud-logout\" onClick={handleLogout}>‚§¥ Logout</button>\n        </div>\n      </header>\n\n      <section className=\"nud-hero\">\n        <div className=\"nud-hero-inner\">\n          <h1>Welcome back, {name}!</h1>\n        </div>\n      </section>\n\n      <section className=\"nud-stats container\">\n        <div className=\"stat-card\">\n          <div className=\"stat-num\">{stats.totalRecipes}</div>\n          <div className=\"stat-label\">Total Recipes</div>\n        </div>\n        <div className=\"stat-card\">\n          <div className=\"stat-num\">{stats.totalCalories.toLocaleString()}</div>\n          <div className=\"stat-label\">Total Calories</div>\n        </div>\n        <div className=\"stat-card\">\n          <div className=\"stat-num\">{stats.favorites}</div>\n          <div className=\"stat-label\">Favorites</div>\n        </div>\n        <div className=\"stat-card\">\n          <div className=\"stat-num\">{stats.avgCalories}</div>\n          <div className=\"stat-label\">Avg Calories</div>\n        </div>\n      </section>\n\n      <section className=\"container\" style={{ paddingTop: 8 }}>\n        <div style={{ maxWidth: 1100, margin: '0 auto 20px', display: 'flex', gap: 12 }}>\n          <input\n            value={query}\n            onChange={e => setQuery(e.target.value)}\n            placeholder=\"Search recipes by title, ingredients, or instructions...\"\n            style={{\n              flex: 1,\n              padding: '12px 14px',\n              borderRadius: 10,\n              border: '1px solid rgba(15,23,42,0.08)',\n              fontSize: 15\n            }}\n          />\n          <button className=\"btn-primary\" onClick={() => {/* implement search */}}>Search</button>\n        </div>\n      </section>\n\n      <main className=\"nud-empty container\">\n        <div className=\"nud-empty-card\">\n          <h2>Your recipes</h2>\n          <p>You have recipes ‚Äî they will show here. Use the search above to filter.</p>\n          <div className=\"nud-actions\">\n            <button className=\"btn-primary\" onClick={goToAdd}>Add New Recipe</button>\n            <Link className=\"btn-secondary\" to=\"/feed\">Explore Public Feed</Link>\n          </div>\n        </div>\n      </main>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}