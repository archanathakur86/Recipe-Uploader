{"ast":null,"code":"import React,{useEffect,useState}from'react';import api from'../services/api';import'./recipeList.css';import RecipeModal from'./RecipeModal';import carbonara from'../assets/carbonara.jpg';import Toast from'./Toast';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function PublicFeed(){var _process$env$REACT_AP;const[recipes,setRecipes]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[modalRecipe,setModalRecipe]=useState(null);const[toast,setToast]=useState({open:false,message:'',undoId:null});const base=((_process$env$REACT_AP=process.env.REACT_APP_API_URL)===null||_process$env$REACT_AP===void 0?void 0:_process$env$REACT_AP.replace('/api',''))||'http://localhost:5000';useEffect(()=>{const fetchFeed=async()=>{setLoading(true);try{const res=await api.get('/recipes/feed');setRecipes(res.data||[]);}catch(err){var _err$response,_err$response$data;setError(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||err.message||'Failed to load feed');}finally{setLoading(false);}};fetchFeed();},[]);const handleDelete=async id=>{try{await api.delete(\"/recipes/\".concat(id));setToast({open:true,message:'Recipe deleted',undoId:id});const res=await api.get('/recipes/feed');setRecipes(res.data||[]);}catch(err){console.error(err);}};const undoDelete=async()=>{if(!toast.undoId)return;try{await api.post(\"/recipes/\".concat(toast.undoId,\"/restore\"));setToast({open:false,message:'',undoId:null});const res=await api.get('/recipes/feed');setRecipes(res.data||[]);}catch(err){console.error(err);}};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:28},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Public Feed\"}),loading&&/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"feed-error\",children:error}),/*#__PURE__*/_jsx(\"div\",{className:\"rl-grid\",children:recipes.map(r=>/*#__PURE__*/_jsxs(\"article\",{className:\"rl-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"rl-image\",style:{backgroundImage:\"url(\".concat(r.imageUrl?r.imageUrl.startsWith('http')?r.imageUrl:base+r.imageUrl:carbonara,\")\")}}),/*#__PURE__*/_jsxs(\"div\",{className:\"rl-body\",children:[/*#__PURE__*/_jsx(\"h3\",{children:r.title}),/*#__PURE__*/_jsx(\"p\",{children:r.summary}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setModalRecipe(r),children:\"View\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleDelete(r._id),children:\"Delete\"})]})]})]},r._id))}),/*#__PURE__*/_jsx(RecipeModal,{open:!!modalRecipe,recipe:modalRecipe,onClose:()=>setModalRecipe(null)}),/*#__PURE__*/_jsx(Toast,{open:toast.open,message:toast.message,actionText:\"Undo\",onAction:undoDelete,onClose:()=>setToast({open:false})})]});}","map":{"version":3,"names":["React","useEffect","useState","api","RecipeModal","carbonara","Toast","jsx","_jsx","jsxs","_jsxs","PublicFeed","_process$env$REACT_AP","recipes","setRecipes","loading","setLoading","error","setError","modalRecipe","setModalRecipe","toast","setToast","open","message","undoId","base","process","env","REACT_APP_API_URL","replace","fetchFeed","res","get","data","err","_err$response","_err$response$data","response","handleDelete","id","delete","concat","console","undoDelete","post","style","padding","children","className","map","r","backgroundImage","imageUrl","startsWith","title","summary","onClick","_id","recipe","onClose","actionText","onAction"],"sources":["/home/navgurukul/Recipe-upload/my-mern-app/client/src/components/PublicFeed.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport api from '../services/api';\nimport './recipeList.css';\nimport RecipeModal from './RecipeModal';\nimport carbonara from '../assets/carbonara.jpg';\nimport Toast from './Toast';\n\nexport default function PublicFeed() {\n  const [recipes, setRecipes] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [modalRecipe, setModalRecipe] = useState(null);\n  const [toast, setToast] = useState({ open: false, message: '', undoId: null });\n\n  const base = process.env.REACT_APP_API_URL?.replace('/api', '') || 'http://localhost:5000';\n\n  useEffect(() => {\n    const fetchFeed = async () => {\n      setLoading(true);\n      try {\n        const res = await api.get('/recipes/feed');\n        setRecipes(res.data || []);\n      } catch (err) {\n        setError(err.response?.data?.message || err.message || 'Failed to load feed');\n      } finally {\n        setLoading(false);\n      }\n    };\n    fetchFeed();\n  }, []);\n\n  const handleDelete = async (id) => {\n    try {\n      await api.delete(`/recipes/${id}`);\n      setToast({ open: true, message: 'Recipe deleted', undoId: id });\n      const res = await api.get('/recipes/feed');\n      setRecipes(res.data || []);\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  const undoDelete = async () => {\n    if (!toast.undoId) return;\n    try {\n      await api.post(`/recipes/${toast.undoId}/restore`);\n      setToast({ open: false, message: '', undoId: null });\n      const res = await api.get('/recipes/feed');\n      setRecipes(res.data || []);\n    } catch (err) {\n      console.error(err);\n    }\n  };\n\n  return (\n    <div style={{ padding: 28 }}>\n      <h2>Public Feed</h2>\n\n      {loading && <div>Loading...</div>}\n      {error && <div className=\"feed-error\">{error}</div>}\n\n      <div className=\"rl-grid\">\n        {recipes.map(r => (\n          <article key={r._id} className=\"rl-card\">\n            <div className=\"rl-image\" style={{ backgroundImage: `url(${r.imageUrl ? (r.imageUrl.startsWith('http') ? r.imageUrl : base + r.imageUrl) : carbonara})` }} />\n            <div className=\"rl-body\">\n              <h3>{r.title}</h3>\n              <p>{r.summary}</p>\n              <div>\n                <button onClick={() => setModalRecipe(r)}>View</button>\n                <button onClick={() => handleDelete(r._id)}>Delete</button>\n              </div>\n            </div>\n          </article>\n        ))}\n      </div>\n\n      <RecipeModal open={!!modalRecipe} recipe={modalRecipe} onClose={() => setModalRecipe(null)} />\n      <Toast open={toast.open} message={toast.message} actionText=\"Undo\" onAction={undoDelete} onClose={() => setToast({ open: false })} />\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}