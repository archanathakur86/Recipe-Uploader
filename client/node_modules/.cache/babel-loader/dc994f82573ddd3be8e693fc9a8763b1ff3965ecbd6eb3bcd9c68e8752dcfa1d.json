{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useParams,useNavigate}from'react-router-dom';import api from'../services/api';import estimateCalories from'../services/calorieEstimator';import Toast from'./Toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function RecipeView(_ref){var _process$env$REACT_AP;let{user}=_ref;const{id}=useParams();const nav=useNavigate();const[r,setR]=useState(null);const[toast,setToast]=useState({open:false,message:'',undoId:null});useEffect(()=>{api.get(\"/recipes/\".concat(id)).then(res=>setR(res.data)).catch(()=>setR(null));},[id]);if(r===null)return/*#__PURE__*/_jsx(\"div\",{style:{padding:24},children:\"Loading...\"});const isOwner=user&&r.owner&&(user._id===r.owner||user._id===r.owner._id);const handleDelete=async()=>{try{await api.delete(\"/recipes/\".concat(id));setToast({open:true,message:'Recipe deleted',undoId:id});// navigate to feed after a short delay so toast is visible\nsetTimeout(()=>nav('/recipes'),800);}catch(err){console.error(err);alert('Delete failed');}};const undoDelete=async()=>{try{if(!toast.undoId)return;await api.post(\"/recipes/\".concat(toast.undoId,\"/restore\"));setToast({open:false,message:'',undoId:null});// reload recipe\nconst res=await api.get(\"/recipes/\".concat(id));setR(res.data);}catch(err){console.error('Undo failed',err);alert('Undo failed');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"card\",style:{padding:18},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0},children:r.title}),r.owner&&/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:13,color:'#475569',marginTop:6},children:[\"By\",' ',/*#__PURE__*/_jsx(\"a\",{href:\"/user/\".concat(r.owner._id?r.owner._id:r.owner),onClick:e=>{e.preventDefault();nav(\"/user/\".concat(r.owner._id?r.owner._id:r.owner));},children:r.owner.name||(typeof r.owner==='string'?r.owner:'Chef')})]})]}),/*#__PURE__*/_jsx(\"div\",{children:isOwner&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{style:{marginRight:8},onClick:()=>nav(\"/recipe/\".concat(id,\"?edit=1\")),children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDelete,style:{background:'#ff4d4f',color:'#fff',border:'none',padding:'8px 12px',borderRadius:8},children:\"Delete\"})]})})]}),r.imageUrl&&/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(((_process$env$REACT_AP=process.env.REACT_APP_API_URL)===null||_process$env$REACT_AP===void 0?void 0:_process$env$REACT_AP.replace('/api',''))||'http://localhost:5000').concat(r.imageUrl),alt:\"\",style:{width:'100%',marginTop:12,borderRadius:10}}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:10},children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Calories:\"}),\" \",r.caloriesTotal&&r.caloriesTotal>0?r.caloriesTotal:estimateCalories(r),\" kcal\"]}),/*#__PURE__*/_jsx(\"h4\",{children:\"Ingredients\"}),/*#__PURE__*/_jsx(\"ul\",{children:(r.ingredients||[]).map((ing,i)=>/*#__PURE__*/_jsxs(\"li\",{children:[ing.name,\" \",ing.quantity?\"(\".concat(ing.quantity,\")\"):'',\" \\u2014 \",ing.calories||'—',\" kcal\"]},i))}),/*#__PURE__*/_jsx(\"h4\",{children:\"Instructions\"}),/*#__PURE__*/_jsx(\"p\",{style:{whiteSpace:'pre-wrap'},children:r.instructions}),/*#__PURE__*/_jsx(Toast,{open:toast.open,message:toast.message,actionText:\"Undo\",onAction:undoDelete,onClose:()=>setToast({open:false})})]});}","map":{"version":3,"names":["React","useEffect","useState","useParams","useNavigate","api","estimateCalories","Toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","RecipeView","_ref","_process$env$REACT_AP","user","id","nav","r","setR","toast","setToast","open","message","undoId","get","concat","then","res","data","catch","style","padding","children","isOwner","owner","_id","handleDelete","delete","setTimeout","err","console","error","alert","undoDelete","post","className","display","justifyContent","alignItems","margin","title","fontSize","color","marginTop","href","onClick","e","preventDefault","name","marginRight","background","border","borderRadius","imageUrl","src","process","env","REACT_APP_API_URL","replace","alt","width","caloriesTotal","ingredients","map","ing","i","quantity","calories","whiteSpace","instructions","actionText","onAction","onClose"],"sources":["/home/navgurukul/Recipe-upload/my-mern-app/client/src/components/RecipeView.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport api from '../services/api';\nimport estimateCalories from '../services/calorieEstimator';\nimport Toast from './Toast';\n\nexport default function RecipeView({ user }) {\n  const { id } = useParams();\n  const nav = useNavigate();\n  const [r, setR] = useState(null);\n  const [toast, setToast] = useState({ open: false, message: '', undoId: null });\n\n  useEffect(() => { api.get(`/recipes/${id}`).then(res => setR(res.data)).catch(() => setR(null)); }, [id]);\n\n  if (r === null) return <div style={{padding:24}}>Loading...</div>;\n\n  const isOwner = user && r.owner && (user._id === r.owner || user._id === r.owner._id);\n\n  const handleDelete = async () => {\n    try {\n      await api.delete(`/recipes/${id}`);\n      setToast({ open: true, message: 'Recipe deleted', undoId: id });\n      // navigate to feed after a short delay so toast is visible\n      setTimeout(() => nav('/recipes'), 800);\n    } catch (err) {\n      console.error(err);\n      alert('Delete failed');\n    }\n  };\n\n  const undoDelete = async () => {\n    try {\n      if (!toast.undoId) return;\n      await api.post(`/recipes/${toast.undoId}/restore`);\n      setToast({ open: false, message: '', undoId: null });\n      // reload recipe\n      const res = await api.get(`/recipes/${id}`);\n      setR(res.data);\n    } catch (err) {\n      console.error('Undo failed', err);\n      alert('Undo failed');\n    }\n  };\n\n  return (\n    <div className=\"card\" style={{ padding: 18 }}>\n      <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n        <div>\n          <h2 style={{ margin: 0 }}>{r.title}</h2>\n          {r.owner && (\n            <div style={{ fontSize: 13, color: '#475569', marginTop: 6 }}>\n              By{' '}\n              <a href={`/user/${r.owner._id ? r.owner._id : r.owner}`} onClick={e => { e.preventDefault(); nav(`/user/${r.owner._id ? r.owner._id : r.owner}`); }}>{r.owner.name || (typeof r.owner === 'string' ? r.owner : 'Chef')}</a>\n            </div>\n          )}\n        </div>\n        <div>\n          {isOwner && (\n            <>\n              <button style={{ marginRight: 8 }} onClick={() => nav(`/recipe/${id}?edit=1`)}>Edit</button>\n              <button onClick={handleDelete} style={{ background: '#ff4d4f', color: '#fff', border: 'none', padding: '8px 12px', borderRadius: 8 }}>Delete</button>\n            </>\n          )}\n        </div>\n      </div>\n\n      {r.imageUrl && <img src={`${process.env.REACT_APP_API_URL?.replace('/api','') || 'http://localhost:5000'}${r.imageUrl}`} alt=\"\" style={{ width: '100%', marginTop: 12, borderRadius: 10 }} />}\n  <div style={{ marginTop: 10 }}><strong>Calories:</strong> {(r.caloriesTotal && r.caloriesTotal > 0 ? r.caloriesTotal : estimateCalories(r))} kcal</div>\n      <h4>Ingredients</h4>\n      <ul>{(r.ingredients || []).map((ing, i) => <li key={i}>{ing.name} {ing.quantity ? `(${ing.quantity})` : ''} — {ing.calories || '—'} kcal</li>)}</ul>\n      <h4>Instructions</h4>\n      <p style={{ whiteSpace: 'pre-wrap' }}>{r.instructions}</p>\n  <Toast open={toast.open} message={toast.message} actionText=\"Undo\" onAction={undoDelete} onClose={() => setToast({ open: false })} />\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}